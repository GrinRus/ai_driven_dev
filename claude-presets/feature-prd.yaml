---
name: feature-prd
workflow_step: 1-idea
description: >
  Подготовка PRD для новой фичи на основе slug-hint пользователя, workflow и шаблона PRD.
variables:
  feature:
    prompt: "Slug активной фичи (например, checkout-improvements)."
  acceptance_criteria:
    prompt: >-
      Буллеты с критериями успеха. Оставьте пустым, если нужно
      сгенерировать.
context:
  files:
    - docs/.active_feature
    - workflow.md
    - docs/prd.template.md
    - docs/customization.md
    - docs/research/{{feature}}.md
    - reports/research/{{feature}}-context.json
    - reports/research/{{feature}}-targets.json
  instructions:
    - >-
      Перед генерацией прочитай slug-hint (docs/.active_feature), docs/research/{{feature}}.md и
      reports/research/{{feature}}-(context|targets).json. Зафиксируй в PRD,
      какие источники использовались, и перечисли команды/пути, которые уже
      проверил.
    - >-
      Заполни PRD для {{feature}}: цели, пользователи, сценарии, метрики,
      риски. Вопросы пользователю задавай только если репозиторий не содержит
      ответа; требуй формат `Ответ N: …`.
    - >-
      Привяжи фичу к гейтам workflow и перечисли связанные ADR/планы,
      указывая ссылки на файлы и команды, которые нужно запускать (например,
      `claude-workflow research --ticket {{feature}} --auto`, `rg` по модулям).
output:
  path: docs/prd/{{feature}}.prd.md
  format: markdown
  mode: overwrite
  scaffold: docs/prd.template.md
claude:
  mode: interact
  temperature: 0.2
  guardrails:
    - "Уточни недостающие вводные перед генерацией."
    - "Проверь, что критерии успеха согласованы с гейтами workflow."
