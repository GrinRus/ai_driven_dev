{
  "extraKnownMarketplaces": {
    "aidd-local": {
      "source": {
        "source": "directory",
        "path": "."
      }
    }
  },
  "enabledPlugins": {
    "feature-dev-aidd@aidd-local": true
  },
  "model": "sonnet",
  "outputStyle": "Explanatory",
  "presets": {
    "active": "strict",
    "instructions": "Измените это поле и скопируйте permissions из presets.list.<name> на верхний уровень, чтобы переключаться между пресетами.",
    "list": {
      "start": {
        "description": "Базовый режим: минимальные права; хуки берутся из плагина feature-dev-aidd.",
        "permissions": {
          "allow": [
            "Read",
            "Write",
            "Edit",
            "Grep",
            "Glob",
            "Find",
            "Bash(find:*)",
            "Bash(rg:*)",
            "Bash(./aidd/tools/set_active_stage.py:*)",
            "Bash(./aidd/tools/set_active_feature.py:*)",
            "Bash(sed:*)",
            "Bash(cat:*)",
            "Bash(xargs:*)",
            "Bash(./gradlew:*)"
          ],
          "ask": [
            "Bash(git add:*)",
            "Bash(git commit:*)"
          ],
          "deny": [
            "Bash(curl:*)",
            "Read(./.env)",
            "Read(./.env.*)",
            "Read(./secrets/**)"
          ]
        }
      },
      "strict": {
        "description": "Строгий режим: расширенные разрешения; сами хуки выполняет плагин feature-dev-aidd.",
        "permissions": {
          "allow": [
            "Read",
            "Write",
            "Edit",
            "Grep",
            "Glob",
            "Find",
            "Read",
            "Bash(git status:*)",
            "Bash(git diff:*)",
            "Bash(git rev-parse:*)",
            "Bash(git checkout:*)",
            "Bash(aidd/hooks/:*)",
            "Bash(find:*)",
            "Bash(rg:*)",
            "Bash(./aidd/tools/set_active_stage.py:*)",
            "Bash(./aidd/tools/set_active_feature.py:*)",
            "Bash(sed:*)",
            "Bash(cat:*)",
            "Bash(xargs:*)",
            "Bash(./gradlew:*)",
            "Bash(python3:*)",
            "Bash(python3 scripts/:*)",
            "Bash(python3 aidd/tools/:*)",
            "Bash(claude-workflow:*)",
            "SlashCommand(/feature-dev-aidd:idea-new:*)",
            "SlashCommand(/feature-dev-aidd:researcher:*)",
            "SlashCommand(/feature-dev-aidd:plan-new:*)",
            "SlashCommand(/feature-dev-aidd:tasks-new:*)",
            "SlashCommand(/feature-dev-aidd:implement:*)",
            "SlashCommand(/feature-dev-aidd:review-spec:*)",
            "SlashCommand(/feature-dev-aidd:review:*)",
            "SlashCommand(/feature-dev-aidd:qa:*)"
          ],
          "ask": [
            "Bash(git add:*)",
            "Bash(git commit:*)",
            "Bash(git push:*)"
          ],
          "deny": [
            "Bash(curl:*)",
            "Read(./.env)",
            "Read(./.env.*)",
            "Read(./secrets/**)",
            "Write(./infra/prod/**)"
          ]
        }
      }
    }
  },
  "permissions": {
    "allow": [
      "Read",
      "Write",
      "Edit",
      "Grep",
      "Glob",
      "Bash(git status:*)",
      "Bash(git diff:*)",
      "Bash(git rev-parse:*)",
      "Bash(git checkout:*)",
      "Bash(aidd/hooks/:*)",
      "Bash(find:*)",
      "Bash(rg:*)",
      "Bash(./aidd/tools/set_active_stage.py:*)",
      "Bash(./aidd/tools/set_active_feature.py:*)",
      "Bash(sed:*)",
      "Bash(cat:*)",
      "Bash(xargs:*)",
      "Bash(./gradlew:*)",
      "Bash(python3:*)",
      "Bash(python3 scripts/:*)",
      "Bash(python3 aidd/tools/:*)",
      "Bash(claude-workflow:*)",
      "SlashCommand(/feature-dev-aidd:idea-new:*)",
      "SlashCommand(/feature-dev-aidd:researcher:*)",
      "SlashCommand(/feature-dev-aidd:plan-new:*)",
      "SlashCommand(/feature-dev-aidd:tasks-new:*)",
      "SlashCommand(/feature-dev-aidd:implement:*)",
      "SlashCommand(/feature-dev-aidd:review-spec:*)",
      "SlashCommand(/feature-dev-aidd:review:*)",
      "SlashCommand(/feature-dev-aidd:qa:*)"
    ],
    "ask": [
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)"
    ],
    "deny": [
      "Bash(curl:*)",
      "Read(./.env)",
      "Read(./.env.*)",
      "Read(./secrets/**)",
      "Write(./infra/prod/**)"
    ]
  },
  "automation": {
    "format": {
      "commands": [],
      "notes": "Добавьте сюда массив команд (например, [ [\"npm\", \"run\", \"format\"] ]) или укажите SKIP_FORMAT=1.",
      "env": {
        "SKIP_FORMAT": "1 — пропустить форматирование;",
        "FORMAT_ONLY": "1 — выполнить только форматирование без тестов."
      }
    },
    "tests": {
      "runner": "bash",
      "defaultTasks": [
        "scripts/ci-lint.sh"
      ],
      "fallbackTasks": [
        "scripts/ci-lint.sh"
      ],
      "changedOnly": true,
      "strictDefault": 1,
      "moduleMatrix": [],
      "reviewerGate": {
        "enabled": true,
        "marker": "reports/reviewer/{slug}.json",
        "field": "tests",
        "requiredValues": [
          "required"
        ],
        "optionalValues": [
          "optional",
          "skipped",
          "not-required"
        ],
        "forceEnv": "FORCE_TESTS",
        "skipEnv": "SKIP_TESTS"
      },
      "env": {
        "SKIP_AUTO_TESTS": "1 — временно отключить автоматический запуск форматирования и выборочных тестов.",
        "TEST_SCOPE": "Список задач через запятую (например, unit,lint).",
        "TEST_CHANGED_ONLY": "0 — запускать полный набор задач независимо от diff.",
        "STRICT_TESTS": "1 — падать при первых ошибках тестов, 0 — только предупреждать.",
        "FORCE_TESTS": "1 — запустить тесты независимо от статуса reviewer.",
        "SKIP_TESTS": "1 — пропустить тесты даже при статусе reviewer=required (не рекомендуется)."
      }
    }
  }
}
